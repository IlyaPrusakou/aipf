managed implementation in class ZBP_R_PRU_AGENT unique;
strict ( 2 );
with draft;
extensible;
define behavior for ZR_PRU_AGENT alias Agent
persistent table zpru_agent
extensible
draft table zpru_agent_d
etag master AIPF7LocalLastChanged
lock master total etag AIPF7LastChanged
authorization master ( global )
{
  field ( numbering : managed ) AIPF7AgentUUID;

  field ( readonly )
  AIPF7LastChanged,
  AIPF7LocalLastChanged;

  field ( readonly )
  AIPF7AgentUUID;

  association _tool { create; with draft; }

  create;
  update;
  delete;

  draft action Activate optimized;
  draft action Discard;
  draft action Edit;
  draft action Resume;
  draft determine action Prepare;

  mapping for zpru_agent corresponding extensible
    {
      AIPF7AgentUUID            = agentuuid;
      AIPF7AgentType            = agenttype;
      AIPF7AgentName            = agentname;
      AIPF7DecisionProvider     = decisionprovider;
      AIPF7ShortMemoryProvider  = shortmemoryprovider;
      AIPF7LongMemoryProvider   = longmemoryprovider;
      AIPF7AgentInfoProvider    = agentinfoprovider;
      AIPF7SystemPromptProvider = systempromptprovider;
      AIPF7AgentStatus          = agentstatus;
      AIPF7CreatedBy            = createdby;
      AIPF7CreatedAt            = createdat;
      AIPF7ChangedBy            = changedby;
      AIPF7LastChanged          = lastchanged;
      AIPF7LocalLastChanged     = locallastchanged;
    }

}

define behavior for ZR_PRU_AGENT_TOOL alias AgentTool
persistent table zpru_agent_tool
extensible
draft table zpru_agenttool_d
etag dependent by _agent
lock dependent by _agent
authorization dependent by _agent
{

  field ( numbering : managed ) AIPF7ToolUuid;
  field ( readonly ) AIPF7ToolUuid, AIPF7AgentUuid;

  update;
  delete;

  association _agent { with draft; }

  mapping for zpru_agent_tool corresponding extensible
    {
      AIPF7ToolUuid           = tooluuid;
      AIPF7AgentUuid          = agentuuid;
      AIPF7ToolName           = toolname;
      AIPF7ToolProvider       = toolprovider;
      AIPF7StepType           = steptype;
      AIPF7ToolSchemaProvider = toolschemaprovider;
      AIPF7ToolInfoProvider   = toolinfoprovider;
      AIPF7ToolIsBorrowed     = toolisborrowed;
      AIPF7ToolIsTransient    = toolistransient;
    }
}